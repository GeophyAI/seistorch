Search.setIndex({"docnames": ["advanced", "configure", "data_format", "getting_started", "head", "index", "quick_start", "running_commands"], "filenames": ["advanced.md", "configure.md", "data_format.md", "getting_started.md", "head.md", "index.rst", "quick_start.md", "running_commands.md"], "titles": ["Advanced Customization", "Configure file", "Data Format", "Getting Started", "Introduction", "Welcome to Seistorch\u2019s documentation!", "Quick Start", "Configuration Parameters for FWI Scripts"], "terms": {"In": [0, 1, 2, 3], "seistorch": [0, 1, 2, 3, 4, 6, 7], "user": [0, 4], "have": [0, 1, 2, 3, 4], "flexibl": [0, 4], "implement": [0, 1], "thi": [0, 1, 2, 3, 4, 6, 7], "level": 0, "allow": [0, 1, 2, 3, 4], "you": [0, 1, 2, 3, 4, 6, 7], "tailor": [0, 7], "specif": [0, 1, 7], "research": [0, 1, 4], "object": [0, 2], "experi": [0, 1, 2, 7], "novel": 0, "algorithm": 0, "chapter": [0, 2], "guid": [0, 6], "through": [0, 4, 6], "process": [0, 1, 2, 3, 4], "creat": [0, 2, 3, 6], "own": [0, 2, 6], "clearli": 0, "mathemat": 0, "form": 0, "includ": [0, 1, 2, 4], "physic": [0, 4], "paramet": [0, 3, 5], "boundari": [0, 1, 2, 4, 6], "condit": [0, 1], "need": [0, 1, 2, 3, 4, 6, 7], "name": [0, 1, 2, 4, 6], "wavefield": [0, 1, 2, 6], "ad": [0, 2], "new": [0, 6], "line": 0, "class": [0, 1], "eqconfigur": [0, 1], "py": [0, 1, 3, 5, 6], "configur": [0, 2, 3, 5, 6], "paramt": [0, 1, 7], "specifi": [0, 1, 2, 3, 7], "which": [0, 1, 2, 3], "model": [0, 1, 4, 5, 7], "ar": [0, 1, 2, 3, 4, 7], "requir": [0, 1, 3, 7], "given": [0, 1], "staticmethod": 0, "def": [0, 2], "valid_model_para": 0, "para": [0, 2], "my_wave_equ": 0, "c": 0, "return": [0, 2], "variabl": 0, "__init__": 0, "self": 0, "acoust": [0, 1, 5], "getattr": 0, "properti": [0, 3, 4], "wavefield1": 0, "wavefield2": 0, "The": [0, 1, 2, 3, 4, 6, 7], "avail": [0, 1, 3], "source_typ": [0, 1], "receiver_typ": [0, 1, 2], "option": 0, "inde": 0, "correspond": [0, 2, 6], "within": [0, 1], "exampl": [0, 1, 2, 3, 6, 7], "geom": [0, 1, 2], "forward": [0, 1, 2, 4, 5, 7], "timestep": 0, "python": [0, 1, 2, 3, 4, 6], "_time_step": 0, "adher": 0, "solver": 0, "interfac": [0, 4], "save": [0, 1, 2, 3, 4, 6], "can": [0, 1, 2, 3, 4, 6, 7], "set": [0, 1, 2, 3, 6, 7], "file": [0, 2, 3, 5, 6, 7], "call": [0, 1, 6, 7], "arg": 0, "0": [0, 1, 3, 7], "vp": [0, 1, 2, 3, 7], "3": [0, 1, 3], "dt": [0, 1], "h": [0, 1], "b": 0, "6": [0, 7], "time": [0, 1, 2], "sampl": [0, 1, 2], "interv": [0, 1], "grid": [0, 1], "size": [0, 1], "coeffici": 0, "pml": [0, 1, 2], "when": [0, 1, 2, 3, 4, 7], "without": [0, 1], "conditon": 0, "y": 0, "wave_equation_forward_in_tim": 0, "all": [0, 1, 2, 3], "scalar": [0, 2], "calcul": [0, 1, 4], "typic": [0, 2], "involv": [0, 3], "us": [0, 1, 2, 3, 4, 6], "valu": [0, 1, 2], "t": [0, 1, 3, 4], "comput": [0, 1, 3, 4, 6, 7], "here": [0, 2, 3], "repres": [0, 1, 2, 3], "respect": [0, 2, 3], "These": [0, 2], "recurs": 0, "each": [0, 1, 2, 4], "thei": 0, "pass": [0, 1, 4], "next": 0, "iter": [0, 2], "backward": [0, 1], "i": [0, 1, 2, 3, 4, 6], "If": [0, 1, 2, 3, 7], "want": [0, 1, 3, 7], "resourc": [0, 4], "pleas": [0, 3, 4], "follow": [0, 1, 2, 3, 4, 6, 7], "note": [0, 1, 2], "suffici": 0, "choos": [0, 4], "onli": [0, 1, 3, 7], "boundary_sav": [0, 1, 6], "fals": [0, 1, 2], "dure": [0, 1, 2, 6], "invers": [0, 1, 2, 4, 5, 7], "wai": 0, "pytorch": [0, 4], "construct": 0, "graph": 0, "automat": [0, 1, 4, 6], "perform": [0, 2, 4, 5], "fwi": [0, 1, 3, 4, 5, 6], "true": [0, 1, 2, 6], "necessari": [0, 1], "context": 0, "torch": [0, 1, 4, 7], "no_grad": 0, "_time_step_backward": 0, "we": [0, 1, 2, 4, 6], "revers": [0, 1], "assign": [0, 3, 7], "reload": 0, "sourc": [0, 1, 3, 4, 5, 6, 7], "essenti": [0, 1, 7], "reconstruct": [0, 1, 6], "enable_grad": 0, "boundary_valu": 0, "_": [0, 1, 3, 6], "2": [0, 2, 3, 6], "src_type": 0, "src_func": 0, "src_valu": 0, "unsqueez": 0, "wave_equation_reverse_in_tim": 0, "restore_boundari": 0, "add": 0, "h1": 0, "easier": 0, "than": [0, 1], "should": [0, 1, 2, 3], "place": 0, "easili": 0, "access": [0, 1, 4], "command": [0, 2, 3], "like": [0, 4, 7], "myloss": 0, "execut": [0, 3], "myloss1": 0, "nn": 0, "modul": [0, 7], "super": [0, 1, 7], "syn": [0, 3], "ob": [0, 1, 3], "ctx": 0, "save_for_backward": 0, "mseloss": 0, "grad_output": 0, "saved_tensor": 0, "adj": 0, "none": 0, "myloss2": 0, "mention": 0, "abov": [0, 3], "ve": 0, "two": [0, 3, 6], "both": [0, 1, 2, 3, 4], "inherit": 0, "from": [0, 1, 2, 3, 4], "attribut": 0, "howev": [0, 2], "": [0, 1, 2, 3, 4], "interest": [0, 1], "although": 0, "method": [0, 6], "gradient": [0, 1, 2, 4, 7], "result": [0, 3, 5, 6, 7], "ident": 0, "between": [0, 1, 3, 6], "modifi": [0, 7], "code": [0, 1, 3, 6], "yml": [1, 2, 3, 6, 7], "crucial": [1, 4], "compon": [1, 2], "your": [1, 2, 3, 4, 5, 6, 7], "seismic": [1, 2, 3, 4, 6], "It": [1, 2], "contain": [1, 2], "determin": [1, 3], "how": [1, 2, 5, 6], "simul": [1, 3, 4, 6, 7], "carri": 1, "out": 1, "document": [1, 4], "describ": [1, 3], "kei": [1, 5], "section": [1, 3, 6, 7], "yaml": [1, 3], "pars": 1, "dictionari": 1, "make": [1, 2, 4], "easi": 1, "util": [1, 2, 3, 4], "script": [1, 3, 5, 6], "read": [1, 2], "import": [1, 2, 3], "cloader": 1, "loader": 1, "load": [1, 2, 4], "config_path": 1, "r": [1, 3], "your_yml_file_path": 1, "open": [1, 2, 4], "ymlfile": 1, "cfg": 1, "provid": [1, 2, 3, 4, 7], "an": [1, 2, 3, 4, 7], "overview": [1, 7], "string": 1, "quotat": 1, "mark": 1, "obspath": 1, "home": 1, "data": [1, 3, 5, 6, 7], "npy": [1, 2, 6], "truepath": [1, 2], "where": [1, 2, 3], "synthet": [1, 3, 7], "gener": [1, 2, 6], "same": [1, 2], "observ": [1, 3, 4, 6, 7], "refer": [1, 3, 5], "fit": [1, 7], "run": [1, 5, 6, 7], "mode": [1, 2, 3], "behavior": 1, "conduct": 1, "error": [1, 2], "subsequ": 1, "log": [1, 2], "tensorboard": [1, 2, 4], "record": [1, 2], "keep": 1, "defin": [1, 2, 3], "variou": [1, 2, 4], "equat": [1, 3, 5], "ha": [1, 4], "its": [1, 3, 4], "list": [1, 5], "miss": 1, "cannot": 1, "rais": 1, "indic": 1, "encount": 1, "issu": 1, "initpath": [1, 2], "work": [1, 3, 4], "initi": [1, 6, 7], "locat": [1, 6], "inform": [1, 2], "receiv": [1, 3, 5, 6], "seab": [1, 7], "about": 1, "shape": [1, 2], "seawat": 1, "area": 1, "1": [1, 2, 3, 4, 7], "other": [1, 3, 4], "region": 1, "sea": 1, "mask": [1, 7], "express": [1, 4], "loss": [1, 2, 3, 5, 6], "grad": [1, 2, 3], "optim": [1, 2, 4, 7], "step": [1, 3, 7], "wavelet": [1, 3], "effect": [1, 4], "fm": 1, "wavelet_delai": 1, "ignor": 1, "For": [1, 2], "valid": [1, 7], "posit": [1, 3], "affirm": 1, "neg": 1, "train": [1, 7], "implicit": 1, "minibatch": 1, "network": [1, 4], "siren": 1, "batch_siz": 1, "classic": [1, 3, 4, 6], "encod": [1, 3, 4, 6, 7], "mani": [1, 4], "individu": 1, "shot": [1, 4, 5, 6, 7], "equal": [1, 2], "one": [1, 2], "epoch": 1, "sigma": 1, "batchsiz": [1, 3], "partial": 1, "w": [1, 3, 4], "mathbf": [1, 3], "x": [1, 3], "m": [1, 3, 4], "singl": [1, 3, 7], "approach": [1, 4], "acceler": [1, 4], "reduc": [1, 4, 6], "cost": 1, "multipl": [1, 2, 4, 7], "absorpt": 1, "upper": 1, "deactiv": 1, "appli": 1, "side": 1, "oper": [1, 2, 3], "strategi": [1, 4, 6], "emploi": 1, "gpu": [1, 2, 3, 4, 6, 7], "memori": [1, 4, 6], "usag": [1, 6, 7], "pure": [1, 6], "differenti": [1, 4, 6], "wavelet_invers": 1, "whether": [1, 7], "invert": [1, 5, 7], "polar": 1, "ricker": 1, "invlist": 1, "multi": 1, "possibl": 1, "focu": 1, "while": [1, 3], "fix": [1, 2, 3], "constrain": 1, "complex": 1, "primarili": 1, "updat": 1, "estim": 1, "subset": 1, "those": [1, 2], "most": [1, 2], "relev": 1, "applic": [1, 3], "elast": 1, "wave": [1, 2, 3, 4, 5, 6], "p": [1, 4], "veloc": [1, 2, 6], "densiti": 1, "unchang": 1, "init_vp": 1, "v": [1, 2, 7], "init_v": 1, "rho": [1, 2, 7], "init_rho": 1, "type": [1, 6], "limit": 1, "caus": 1, "select": 1, "fall": 1, "outsid": 1, "predefin": 1, "dtype": 1, "default": 1, "float32": 1, "store": [1, 2], "function": [1, 2, 4, 5, 7], "control": [1, 4], "influenc": 1, "analysi": 1, "txx": 1, "tzz": 1, "vx": [1, 2], "vz": [1, 2], "seed": 1, "random": [1, 2], "reproduc": [1, 2], "outcom": 1, "see": 1, "n_epoch": 1, "number": [1, 2, 3, 7], "scale": [1, 4], "lr": [1, 3], "learn": [1, 6, 7], "rate": [1, 2, 7], "scale_decai": 1, "lr_decai": 1, "decai": 1, "across": [1, 3, 4], "differ": [1, 2, 7], "exponenti": 1, "th": 1, "n": [1, 2], "frequenc": [1, 2], "band": [1, 2], "init": 1, "filter_ord": 1, "order": 1, "filter": 1, "recommand": 1, "4": [1, 3, 4], "delai": 1, "multiscal": 1, "domin": 1, "A": [1, 4, 6], "low": 1, "keyword": 1, "origin": [1, 2], "5": [1, 3, 4, 7], "also": [1, 2, 7], "nt": [1, 2], "leav": 1, "blank": 1, "z": 1, "direct": 1, "nshot": [1, 2], "bigger": 1, "length": [1, 2], "actual": [1, 2, 3], "minimum": 1, "ensur": [1, 2, 4], "doe": 1, "exce": [1, 3], "min": 1, "len": 1, "width": 1, "introduc": 2, "well": [2, 6], "recommend": 2, "particularli": [2, 4], "effici": [2, 4, 6], "conveni": 2, "especi": 2, "2d": 2, "3d": 2, "nz": 2, "nx": 2, "advantag": 2, "numpi": [2, 4], "np": 2, "matplotlib": 2, "pyplot": 2, "plt": 2, "rand": 2, "replac": 2, "imshow": 2, "show": [2, 6], "loaded_model": 2, "pkl": 2, "pickl": 2, "write": [2, 5], "geometri": [2, 3, 6, 7], "write_pkl": 2, "path": [2, 3], "str": 2, "binari": 2, "wb": 2, "f": [2, 3], "dump": 2, "read_pkl": 2, "rb": 2, "coordin": 2, "case": 2, "mai": [2, 7], "structur": 2, "outer": 2, "item": 2, "inner": 2, "associ": 2, "src_x1": 2, "src_z1": 2, "src_x2": 2, "src_z2": 2, "rec_x1": 2, "rec_x2": 2, "rec_x3": 2, "rec_z1": 2, "rec_z2": 2, "rec_z3": 2, "muet": 2, "so": [2, 3], "them": 2, "purpos": 2, "do": [2, 3], "more": 2, "fiexabl": 2, "chang": [2, 6], "geomtri": 2, "obc": 2, "acquisit": 2, "four": [2, 3], "dimens": 2, "nsampl": 2, "ntrace": 2, "ncompon": 2, "first": [2, 6], "being": 2, "second": 2, "point": 2, "third": 2, "trace": 2, "fourth": 2, "20": [2, 3, 7], "10": [2, 3, 7], "2000": 2, "To": [2, 3, 4], "handl": 2, "empti": 2, "ndarrai": 2, "arrai": 2, "obtain": 2, "therefor": 2, "allow_pickl": 2, "proper": 2, "under": 2, "folder": [2, 6], "tensorboard_log_fil": 2, "02d": 2, "e": 2, "displai": 2, "view": 2, "logdir": 2, "cpu": [2, 3, 7], "valuabl": [2, 4], "insight": [2, 4], "metric": 2, "relat": 2, "start": [2, 4, 5], "respec": 2, "10th": 2, "would": [2, 3, 4], "paravsf00e09": 2, "gradvsf00e09": 2, "directli": 2, "assum": 2, "perfectli": 2, "match": 2, "layer": [2, 6], "thick": 2, "2n": 2, "mean": [2, 3], "pad": [2, 6], "bottom": 2, "left": 2, "right": 2, "summari": 2, "progress": 2, "minim": [2, 3], "download": 3, "begin": 3, "github": 3, "repositori": 3, "clone": 3, "local": 3, "machin": 3, "git": 3, "http": 3, "com": 3, "replace_this_after_upload": 3, "codingfwi": [3, 5], "full": [3, 4, 5], "waveform": [3, 4, 5], "task": [3, 4, 7], "base": [3, 4, 6], "yet": 3, "propag": [3, 6], "d": [3, 4], "subsurfac": [3, 4], "xr": 3, "detector": 3, "signatur": 3, "prepar": [3, 7], "templat": 3, "found": [3, 6, 7], "detail": 3, "host": 3, "ip": 3, "address": 3, "below": 3, "127": 3, "intend": 3, "One": 3, "respons": 3, "o": 3, "node": [3, 4], "total": 3, "node1": 3, "node2": 3, "option1": 3, "option2": 3, "card": 3, "sequenti": 3, "manner": 3, "shell": [3, 6], "On": 3, "support": [3, 4, 7], "mpirun": 3, "cuda": 3, "must": 3, "absolut": 3, "goal": 3, "recov": [3, 4], "misfit": 3, "written": 3, "argmin": 3, "similar": 3, "adjust": 3, "up": [3, 4], "find": 3, "instruct": 3, "just": [3, 7], "skip": 3, "procedur": 3, "distribut": 3, "guidanc": 3, "classi": 3, "opt": 3, "adam": 3, "l2": [3, 7], "parh_for_sav": 3, "cut": 3, "gpuid": 3, "path_for_sav": 3, "smooth": [3, 6], "specfi": 3, "packag": 4, "power": 4, "design": 4, "field": 4, "geophys": 4, "techniqu": 4, "compar": [4, 6], "simplifi": 4, "streamlin": 4, "profession": 4, "earth": 4, "scienc": 4, "develop": 4, "entir": 4, "eas": 4, "compat": 4, "environ": 4, "leverag": 4, "capabl": 4, "fundament": 4, "aspect": 4, "parallel": [4, 7], "equip": 4, "significantli": [4, 6], "guidelin": 4, "get": [4, 5], "balanc": 4, "mpi": 4, "alloc": 4, "maxim": 4, "speed": 4, "offer": 4, "consumpt": 4, "larg": 4, "variant": 4, "accumul": 4, "supershot": 4, "give": 4, "suit": 4, "friendli": 4, "come": 4, "intuit": 4, "api": 4, "extens": 4, "beginn": 4, "experienc": 4, "geophysicist": 4, "befor": [4, 7], "instal": 4, "mpi4pi": 4, "pot": 4, "torchvis": 4, "tqdm": 4, "pyyaml": 4, "mpich": 4, "reli": 4, "messag": 4, "version": [4, 6], "system": 4, "instanc": 4, "our": 4, "sincer": 4, "gratitud": 4, "contributor": 4, "project": 4, "wavetorch": 4, "Their": 4, "been": 4, "signific": 4, "inspir": 4, "contribut": 4, "innov": 4, "solut": 4, "seismologi": 4, "certain": 4, "convent": 4, "wavecel": 4, "wavernn": 4, "wavesourc": 4, "waveprob": 4, "etc": 4, "idea": 4, "codebas": 4, "hugh": 4, "williamson": 4, "minkov": 4, "fan": 4, "analog": 4, "recurr": 4, "neural": 4, "advanc": [4, 5], "vol": 4, "12": 4, "eaay6946": 4, "dec": 4, "2019": 4, "introduct": 5, "featur": 5, "depend": 5, "acknowledg": 5, "quick": 5, "format": 5, "gather": [5, 6], "custom": 5, "welcom": 6, "walk": 6, "basic": 6, "ll": 6, "cover": 6, "topic": 6, "forward_model": 6, "directori": 6, "cd": 6, "pair": 6, "generate_model_geometri": 6, "figur": 6, "png": 6, "illustr": 6, "sh": 6, "shot_gath": 6, "show_shotgath": 6, "plot": 6, "acoustic_fwi": 6, "exmapl": 6, "workflow": 6, "bsad": 6, "backpropag": 6, "srcipt": 6, "ground": 6, "truth": 6, "li": 6, "config": 6, "differeni": 6, "inversion_ad": 6, "inversion_b": 6, "ad_vs_b": 6, "sacrific": 6, "some": 6, "addit": 7, "role": 7, "achiev": 7, "success": 7, "descript": 7, "thread": 7, "intraop": 7, "paral": 7, "sepcifi": 7, "argument": 7, "overwrit": 7, "inv_savepath": 7, "mse": 7, "78": 7, "25": 7, "acceelr": 7, "id": 7, "l1": 7}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"advanc": 0, "custom": 0, "write": 0, "your": 0, "wave": 0, "equat": 0, "step": 0, "1": 0, "defin": 0, "loss": [0, 7], "function": 0, "configur": [1, 7], "file": 1, "format": [1, 2], "paramet": [1, 2, 7], "path": [1, 7], "relat": 1, "boolean": 1, "restrict": 1, "choic": 1, "scalar": 1, "data": 2, "model": [2, 3, 6], "sourc": 2, "receiv": 2, "list": 2, "shot": 2, "gather": 2, "invert": 2, "result": 2, "get": 3, "start": [3, 6], "how": 3, "run": 3, "forward": [3, 6], "perform": [3, 6], "invers": [3, 6], "introduct": 4, "kei": 4, "featur": 4, "depend": 4, "acknowledg": 4, "refer": 4, "welcom": 5, "seistorch": 5, "": 5, "document": 5, "content": 5, "quick": 6, "acoust": 6, "full": 6, "waveform": 6, "fwi": 7, "script": 7, "py": 7, "config": 7, "num_thread": 7, "save": 7, "lr": 7, "mode": 7, "grad": 7, "cut": 7, "codingfwi": 7, "us": 7, "cuda": 7, "gpuid": 7, "batchsiz": 7, "smooth": 7}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 60}, "alltitles": {"Advanced Customization": [[0, "advanced-customization"]], "Writing Your Custom Wave Equation": [[0, "writing-your-custom-wave-equation"]], "Step 1: Define the Wave Equation": [[0, "step-1-define-the-wave-equation"]], "Writing Your Custom Loss function": [[0, "writing-your-custom-loss-function"]], "Configure file": [[1, "configure-file"]], "Format of configure file": [[1, "format-of-configure-file"]], "Parameters in Configure File": [[1, "parameters-in-configure-file"]], "Path related parameters": [[1, "path-related-parameters"]], "Boolean parameters": [[1, "boolean-parameters"]], "Restricted choice parameter": [[1, "restricted-choice-parameter"]], "Scalar parameters": [[1, "scalar-parameters"]], "Data Format": [[2, "data-format"]], "Model parameters": [[2, "model-parameters"]], "Source and receivers list": [[2, "source-and-receivers-list"]], "Shot gather": [[2, "shot-gather"]], "Inverted results": [[2, "inverted-results"]], "Getting Started": [[3, "getting-started"]], "How to run forward modeling": [[3, "how-to-run-forward-modeling"]], "How to perform inversion": [[3, "how-to-perform-inversion"]], "Introduction": [[4, "introduction"]], "Key Features": [[4, "key-features"]], "Dependencies": [[4, "dependencies"]], "Acknowledgements": [[4, "acknowledgements"]], "Reference": [[4, "reference"]], "Welcome to Seistorch\u2019s documentation!": [[5, "welcome-to-seistorch-s-documentation"]], "Contents:": [[5, null]], "Quick Start": [[6, "quick-start"]], "Perform forward modeling": [[6, "perform-forward-modeling"]], "Perform acoustic full waveform inversion": [[6, "perform-acoustic-full-waveform-inversion"]], "Configuration Parameters for FWI Scripts": [[7, "configuration-parameters-for-fwi-scripts"]], "Parameters for fwi.py": [[7, "parameters-for-fwi-py"]], "Parameter: [config]": [[7, "parameter-config"], [7, "id1"]], "Parameter: [num_threads]": [[7, "parameter-num-threads"], [7, "id2"]], "Parameter: [save-path]": [[7, "parameter-save-path"], [7, "id4"]], "Parameter: [loss]": [[7, "parameter-loss"], [7, "id3"]], "Parameter: [lr]": [[7, "parameter-lr"], [7, "id5"]], "Parameter: [mode]": [[7, "parameter-mode"]], "Parameter: [grad-cut]": [[7, "parameter-grad-cut"], [7, "id6"]], "Parameters for codingfwi.py": [[7, "parameters-for-codingfwi-py"]], "Parameter: [use-cuda]": [[7, "parameter-use-cuda"]], "Parameter: [gpuid]": [[7, "parameter-gpuid"]], "Parameter: [batchsize]": [[7, "parameter-batchsize"]], "Parameter: [grad-smooth]": [[7, "parameter-grad-smooth"]]}, "indexentries": {}})