Configuration: config/coding.yml
Using CUDA for calculation
Using adam
'vs' found, but get equation acoustic and skipped
'rho' found, but get equation acoustic and skipped
The results will be saving at '/mnt/data/wangsw/inversion/marmousi_10m/acoustic/l2_bptt'
LEARNING_RATE of VP: 5
BATCHSIZE: 20
Using wavelet func.
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  25133 KiB |  43565 KiB | 394093 KiB | 368960 KiB |
|---------------------------------------------------------------------------|
| Active memory         |  25133 KiB |  43565 KiB | 394093 KiB | 368960 KiB |
|---------------------------------------------------------------------------|
| Requested memory      |  24230 KiB |  41761 KiB | 375168 KiB | 350937 KiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  59392 KiB |  59392 KiB |  59392 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  15827 KiB |  20398 KiB |  20718 KiB |   4891 KiB |
|---------------------------------------------------------------------------|
| Allocations           |       8    |       9    |      48    |      40    |
|---------------------------------------------------------------------------|
| Active allocs         |       8    |       9    |      48    |      40    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       4    |       4    |       4    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  40037 KiB | 224282 KiB | 491803 MiB | 491764 MiB |
|---------------------------------------------------------------------------|
| Active memory         |  40037 KiB | 224282 KiB | 491803 MiB | 491764 MiB |
|---------------------------------------------------------------------------|
| Requested memory      |  39133 KiB | 212930 KiB | 491656 MiB | 491617 MiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 245760 KiB | 245760 KiB | 245760 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  21403 KiB |  41026 KiB | 546655 MiB | 546634 MiB |
|---------------------------------------------------------------------------|
| Allocations           |      17    |   36017    |  483978    |  483961    |
|---------------------------------------------------------------------------|
| Active allocs         |      17    |   36017    |  483978    |  483961    |
|---------------------------------------------------------------------------|
| GPU reserved segments |      70    |      70    |      70    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       5    |    4005    |  243362    |  243357    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  44296 KiB | 232827 KiB |    960 GiB |    960 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  44296 KiB | 232827 KiB |    960 GiB |    960 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  43391 KiB | 221473 KiB |    959 GiB |    959 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 266240 KiB | 266240 KiB | 266240 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  17144 KiB |  51509 KiB |   1137 GiB |   1137 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      21    |   36025    |     967 K  |     967 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      21    |   36025    |     967 K  |     967 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |      71    |      71    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |    4005    |  493265    |  493258    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  48555 KiB | 237086 KiB |   1440 GiB |   1440 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  48555 KiB | 237086 KiB |   1440 GiB |   1440 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  47650 KiB | 225731 KiB |   1439 GiB |   1439 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 266240 KiB | 266240 KiB | 266240 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  33365 KiB |  51509 KiB |   1617 GiB |   1617 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      25    |   36029    |    1451 K  |    1451 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      25    |   36029    |    1451 K  |    1451 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |      71    |      71    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |    4070    |     879 K  |     879 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  52814 KiB | 241345 KiB |   1920 GiB |   1920 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  52814 KiB | 241345 KiB |   1920 GiB |   1920 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  51908 KiB | 229989 KiB |   1919 GiB |   1919 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 266240 KiB | 266240 KiB | 266240 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  29106 KiB |  51509 KiB |   2205 GiB |   2205 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      29    |   36033    |    1935 K  |    1935 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      29    |   36033    |    1935 K  |    1935 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      71    |      71    |      71    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |    4070    |    1250 K  |    1250 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  57073 KiB | 245604 KiB |   2400 GiB |   2400 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  57073 KiB | 245604 KiB |   2400 GiB |   2400 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  56166 KiB | 234247 KiB |   2399 GiB |   2399 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 286720 KiB | 286720 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  24847 KiB |  51509 KiB |   2747 GiB |   2747 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      33    |   36037    |    2419 K  |    2419 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      33    |   36037    |    2419 K  |    2419 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      72    |      72    |      72    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       8    |    4070    |    1609 K  |    1609 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  61332 KiB | 249863 KiB |   2880 GiB |   2880 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  61332 KiB | 249863 KiB |   2880 GiB |   2880 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  60424 KiB | 238505 KiB |   2879 GiB |   2879 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 286720 KiB | 286720 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  20588 KiB |  54953 KiB |   3227 GiB |   3227 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      37    |   36041    |    2903 K  |    2903 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      37    |   36041    |    2903 K  |    2903 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      72    |      72    |      72    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       6    |    4070    |    1968 K  |    1968 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  65591 KiB | 254122 KiB |   3360 GiB |   3360 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  65591 KiB | 254122 KiB |   3360 GiB |   3360 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  64682 KiB | 242764 KiB |   3359 GiB |   3359 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 286720 KiB | 286720 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  36809 KiB |  54953 KiB |   3707 GiB |   3707 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      41    |   36045    |    3387 K  |    3387 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      41    |   36045    |    3387 K  |    3387 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      72    |      72    |      72    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       7    |    4070    |    2321 K  |    2321 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  69850 KiB | 258381 KiB |   3840 GiB |   3840 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  69850 KiB | 258381 KiB |   3840 GiB |   3840 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  68941 KiB | 247022 KiB |   3839 GiB |   3839 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 286720 KiB | 286720 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  32550 KiB |  54953 KiB |   4241 GiB |   4241 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      45    |   36049    |    3871 K  |    3871 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      45    |   36049    |    3871 K  |    3871 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      72    |      72    |      72    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |    4070    |    2669 K  |    2669 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  74109 KiB | 262559 KiB |   4328 GiB |   4328 GiB |
|---------------------------------------------------------------------------|
| Active memory         |  74109 KiB | 262559 KiB |   4328 GiB |   4328 GiB |
|---------------------------------------------------------------------------|
| Requested memory      |  73199 KiB | 251280 KiB |   4318 GiB |   4318 GiB |
|---------------------------------------------------------------------------|
| GPU reserved memory   | 286720 KiB | 286720 KiB | 286720 KiB |      0 B   |
|---------------------------------------------------------------------------|
| Non-releasable memory |  26243 KiB |  54953 KiB |   4766 GiB |   4766 GiB |
|---------------------------------------------------------------------------|
| Allocations           |      49    |   36053    |    4355 K  |    4355 K  |
|---------------------------------------------------------------------------|
| Active allocs         |      49    |   36053    |    4355 K  |    4355 K  |
|---------------------------------------------------------------------------|
| GPU reserved segments |      72    |      72    |      72    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       9    |    4071    |    3031 K  |    3030 K  |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

